async function kvSelect(e){if(!(e instanceof Element))return void document.querySelectorAll("select.kvSelect").forEach((e=>kvSelect(e)));const t=document.createElement("span");function n(e){const t=e.previousElementSibling.value;for(const n of e.options)n.style.display="*"===n.innerText||n.hasAttribute("selected")||""===t||-1!=n.innerText.toLowerCase().indexOf(t)?"":"none";e.value=""}t.classList=e.classList,e.classList="",e.insertAdjacentHTML("afterbegin","<option>*</option>"),t.insertAdjacentHTML("afterbegin",`<input type="search" style="display:block;margin-bottom:1px" placeholder="${e.getAttribute("placeholder")}">`),e.insertAdjacentElement("beforebegin",t),t.insertAdjacentElement("beforeend",e),e.style.width=`${t.firstChild.getBoundingClientRect().width}px`,t.firstChild.addEventListener("input",(e=>{e.target.nextElementSibling.options[0].removeAttribute("selected"),n(e.target.nextElementSibling)})),n(e),e.addEventListener("click",(t=>{const i=t.target;if(i.hasAttribute("selected")?i.removeAttribute("selected"):i.setAttribute("selected",""),"*"===i.innerText){const t=i.hasAttribute("selected");for(let n of e.options)"none"!==n.style.display&&(t?n.setAttribute("selected",""):n.removeAttribute("selected"))}else e.options[0].removeAttribute("selected");n(t.currentTarget)})),e.addEventListener("keydown",(e=>{const t=e.currentTarget;"Enter"===e.key?t.options[t.selectedIndex].click():"Delete"===e.key&&(t.previousElementSibling.value="")}))}window.addEventListener("load",kvSelect);