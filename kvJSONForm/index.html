<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Form</title>
    <link rel="stylesheet" href="./kvJSONForm.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"
        integrity="sha512-q3eWabyZPc1XTCmF+8/LuE1ozpg5xxn7iO89yfSOd5/oKvyqLngoNGsx8jq92Y8eXJ/IRxQbEC+FGSYxtk2oiw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="./kvJSONForm.js"></script>
    <script>
        async function setup() {
            let response = await fetch('./data.json');
            document.querySelector('[data-json="schedaTutor"]').value = await response.text();
            kvJSONForm();
        }
    </script>
</head>

<body onload="setup()">
    <form name="regularTable">
        <textarea name="Schema" data-json="Schema"></textarea>

        <table class="sortable" form="json" name="campi">
            <thead>
                <tr>
                    <th style="width:1em"></th>
                    <th>Tipo</th>
                    <th style="width:100%">Etichetta</th>
                    <th>Valore predefinito</th>
                    <th>Privacy</th>
                    <th style="width:1em"><i class="fas fa-exclamation" title="Obbligatorio"></i></th>
                    <th style="width:1em"></th>
            </thead>
            <tbody class="dataRow">
                <tr>
                    <td><i class="fas fa-grip-vertical"></i></td>
                    <td><select form="json" name="tipo">
                            <option value="number">Numero</option>
                            <option value="text">Testo</option>
                            <option value="date">Data</option>
                            <option value="select">Selezione</option>
                            <option value="textarea">Note</option>
                            <option value="section">Intestazione</option>
                        </select></td>
                    <td><input type="text" form="json" name="etichetta" required></td>
                    <td><input type="text" form="json" name="valore"></td>
                    <td><select form="json" name="classe">
                            <option value="1">-</option>
                            <option value="2">Identificativo</option>
                            <option value="4">Giudiziario</option>
                            <option value="8">Sensibile</option>
                            <option value="16">Sensibilissimo</option>
                            <option value="0">Obsoleto</option>
                        </select></td>
                    <td><input form="json" type="checkbox" name="obbligatorio"></td>
                    <td class="deleteRow"><i class="fas fa-fw fa-trash"></i></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td class="newRow" colspan="7"><i class="fas fa-fw fa-plus"></i> Aggiungi campo</td>
                </tr>
            </tfoot>
        </table>
    </form>

    <form name="fixedTable">
        <textarea name="fDati" data-json="schedaTutor"></textarea>

        <h2>Regular data inputs</h2>
        <label><span>Regular Form data</span> <input name="faa" required></label>
        <hr>
        <label><span>JSON Field data</span> <input form="json" name="foo" required></label>

        <table form="json" name="tutor_VR" data-key="_id">
            <caption>SEZIONE DI CONTROLLO STATO ADEMPIMENTI: VR = Documenti di Valutazione Rischi</caption>
            <thead>
                <tr><th colspan="6"></th><th colspan="3">Esito della verifica</th></tr>
                <tr><th></th><th style="width:35%">Adempimento</th><th>Stato</th><th>Data</th><th>Scadenza</th><th style="width:30%">Conclusioni e Note</th><th>NC</th><th>RACC</th><th>SUGG</th></tr>
            </thead>
            <tbody class="dataRow">
                <tr><td><input form="json" type="hidden" name="_id"></td><td form="json" name="adempimento"></td>
                    <td>
                        <select form="json" name="stato">
                            <option></option>
                            <option>DVR</option>
                            <option>DVR specifico</option>
                            <option>Nel DVR generale</option>
                            <option style="color:red">Necessario ma assente</option>
                            <option>Non applicabile</option>
                        </select></td><td><input form="json" type="date" name="data"></td><td><input form="json" type="date" name="scadenza"></td><td>
                        <div form="json" name="note" contenteditable="plaintext-only"></div>
                    </td><td><input form="json" type="number" name="NC" style="width:6ex" min="0"></td><td><input form="json" type="number" name="RACC" style="width:6ex" min="0"></td><td><input form="json" type="number" name="SUGG" style="width:6ex" min="0"></td></tr>
            </tbody>
            <tbody data-key="1">
                <tr><td></td><td form="json" name="adempimento">DVR generale</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="2">
                <tr><td></td><td form="json" name="adempimento">VR ambienti confinati</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="3">
                <tr><td></td><td form="json" name="adempimento">VR macchine/attrezzature (rischi meccanici)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="4">
                <tr><td></td><td form="json" name="adempimento">VR elettrico</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="5">
                <tr><td></td><td form="json" name="adempimento">VR fulminazione</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="6">
                <tr><td></td><td form="json" name="adempimento">VR incendio</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="7">
                <tr><td></td><td form="json" name="adempimento">VR esplosione (ATEX)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="8">
                <tr><td></td><td form="json" name="adempimento">VR agenti chimici</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="9">
                <tr><td></td><td form="json" name="adempimento">VR agenti cancerogeni</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="10">
                <tr><td></td><td form="json" name="adempimento">VR biologico</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="11">
                <tr><td></td><td form="json" name="adempimento">VR amianto</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="12">
                <tr><td></td><td form="json" name="adempimento">VR rumore</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="13">
                <tr><td></td><td form="json" name="adempimento">VR vibrazioni meccaniche</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="14">
                <tr><td></td><td form="json" name="adempimento">VR radiazioni ottiche artificiali (ROA)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="15">
                <tr><td></td><td form="json" name="adempimento">VR campi elettromagnetici (CEM)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="16">
                <tr><td></td><td form="json" name="adempimento">VR MMC - Sollevamento e trasporto</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="17">
                <tr><td></td><td form="json" name="adempimento">VR MMC - Movimenti ripetitivi</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="18">
                <tr><td></td><td form="json" name="adempimento">VR MMC - Spinta e traino</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="19">
                <tr><td></td><td form="json" name="adempimento">VR lavoro al videoterminale</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="20">
                <tr><td></td><td form="json" name="adempimento">VR stress lavoro correlato</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="28">
                <tr><td></td><td form="json" name="adempimento">VR stress lavoro solitario-isolato</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="21">
                <tr><td></td><td form="json" name="adempimento">VR lavoratrici madri</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="22">
                <tr><td></td><td form="json" name="adempimento">VR lavoratori minori</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="23">
                <tr><td></td><td form="json" name="adempimento">VR lavoro notturno</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="24">
                <tr><td></td><td form="json" name="adempimento">VR differenze di genere, età, tipologia contrattuale</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="25">
                <tr><td></td><td form="json" name="adempimento">VR interferenze appalti (DUVRI)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="26">
                <tr><td></td><td form="json" name="adempimento">Piano sicurezza lavori esterni (POS o simile)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tbody data-key="27">
                <tr><td></td><td form="json" name="adempimento">VR altri fattori (VEDI NOTE)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tfoot>
                <tr><th colspan="6" style="text-align: left">Totali</th>
                    <th><output name="NC_tot" for="NC" data-action="sum"></output></th>
                    <th><output name="RACC_tot" for="RACC" data-action="sum"></output></th>
                    <th><output name="SUGG_tot" for="SUGG" data-action="sum"></output></th>
                </tr>
            </tfoot>
        </table>

        <button type="submit" class="sticky">Salva</button>
        <button type="submit" class="stickyWarning">Elimina</button>
    </form>
</body>

</html>